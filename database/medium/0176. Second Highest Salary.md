## Schema
```
drop table if exists Employee
Create table Employee (id int, salary int)
insert into Employee (id, salary) values ('1', '100')
insert into Employee (id, salary) values ('2', '200')
insert into Employee (id, salary) values ('3', '300')
```

## Question

Table: Employee

```
+-------------+------+
| Column Name | Type |
+-------------+------+
| id          | int  |
| salary      | int  |
+-------------+------+
```

id is the primary key (column with unique values) for this table.
Each row of this table contains information about the salary of an employee.

 

Write a solution to find the second highest distinct salary from the Employee table. If there is no second highest salary, return null (return None in Pandas).

The result format is in the following example.

 

Example 1:

Input: 
Employee table:

```
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
| 2  | 200    |
| 3  | 300    |
+----+--------+
```

Output: 
```
+---------------------+
| SecondHighestSalary |
+---------------------+
| 200                 |
+---------------------+
```

Example 2:

Input: 
Employee table:
```
+----+--------+
| id | salary |
+----+--------+
| 1  | 100    |
+----+--------+
```

Output: 
```
+---------------------+
| SecondHighestSalary |
+---------------------+
| null                |
+---------------------+
```





## My Solution attemp 1
```
with CTE as
(
select distinct salary,
dense_rank() over (order by salary) as rank
from employee
)

select
case when rank = 2 then salary
		else null
		end as SecondHighestSalary
from CTE
order by SecondHighestSalary desc
offset 0 rows fetch next 1 row only
```

<img width="674" height="444" alt="image" src="https://github.com/user-attachments/assets/6015eb35-1203-4182-a01f-227ff3250b6d" />




## My Solution attemp 2
```
with CTE as
(
select distinct salary,
dense_rank() over (order by salary desc) as rank
from employee
)

select max(salary) as SecondHighestSalary
from CTE
where rank = 2
```

## AI Solution
```
SELECT MAX(salary) AS SecondHighestSalary
FROM (
    SELECT salary, DENSE_RANK() OVER (ORDER BY salary DESC) AS rnk
    FROM Employee
) t
WHERE rnk = 2;
```
